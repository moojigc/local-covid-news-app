<!DOCTYPE html>
<html lang="en-us">

<head>
    <meta charset="UTF-8">
    <title>COVID-19 News and Data</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/foundation-sites@6.4.3/dist/css/foundation.min.css" integrity="sha256-GSio8qamaXapM8Fq9JYdGNTvk/dgs+cMLgPeevOYEx0= sha384-wAweiGTn38CY2DSwAaEffed6iMeflc0FMiuptanbN4J+ib+342gKGpvYRWubPd/+ sha512-QHEb6jOC8SaGTmYmGU19u2FhIfeG+t/hSacIWPpDzOp5yygnthL3JwnilM7LM1dOAbJv62R+/FICfsrKUqv4Gg==" crossorigin="anonymous">
	<link
      rel="stylesheet"
      href="https://use.fontawesome.com/releases/v5.8.1/css/all.css"
      integrity="sha384-50oBUHEmvpQ+1lW4y57PTFmhCaXp0ML5d60M1M7uH2+nqUivzIebhndOJK28anvf"
      crossorigin="anonymous"
    />
    <link href="https://fonts.googleapis.com/css?family=Poppins|Roboto|Quicksand&display=swap" rel="stylesheet"> 
    <link rel="stylesheet" type="text/css" href="style.css">
    <!-- <link rel="stylesheet" type="text/css" href="assets/media.css">     -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/foundation-sites@6.4.3/dist/js/foundation.min.js" integrity="sha256-mRYlCu5EG+ouD07WxLF8v4ZAZYCA6WrmdIXyn1Bv9Vk= sha384-KzKofw4qqetd3kvuQ5AdapWPqV1ZI+CnfyfEwZQgPk8poOLWaabfgJOfmW7uI+AV sha512-0gHfaMkY+Do568TgjJC2iMAV0dQlY4NqbeZ4pr9lVUTXQzKu8qceyd6wg/3Uql9qA2+3X5NHv3IMb05wb387rA==" crossorigin="anonymous"></script>
</head>

<body>
    <header class="grid-container fluid">
        <div class="grid-x">
            <h1 class="cell">COVID-19</h1>
            <h5 class="cell">Get the lastest news and data for your city</h3>
        </div>
    </header>
   
    <main class="grid-container wrapper">
        <form>
            <div class="grid-container">
                <div class="grid-x grid-padding-x">
                    <div style="display: inline-flex;" class="cell">
                        <input id="user-location-search" type="text" placeholder="Search your city..." value="">
                        <button id="submit-button" type="button" class="button">
                            <i class="fas fa-search"></i>
                        </button>
                    </div>
                    <p style="margin: -1rem auto 1rem auto">Enter your state or country to get started.</p>
                </div>
            </div>
        </form>
        <div class="grid-x">
            <div class="large-6 cell display-none">
                <h3>Latest news</h3>
                <div id="news-div" class="grid-container">
                
                </div>
            </div>
            <div class="large-6 cell display-none">
                <h3>Data on your area</h3>
                <div id="data-div" class="grid-container">
                    

                </div>
            </div>
        </div>
        
    </main>

    <footer>
        â’¸ Sebastian Williams, David Shalmi, Moojig Battsogt 2020
    </footer>

</body>

<script>
    // including this so you can copy the DOM manipulation part
    var responseData;
    var dataDiv = $('#data-div');
    var newsDiv = $('#news-div');
    function newsAPI(search, location) {
        var apiKey = '5b5900f1a1e0479491c99baf6798e14f'
        var location = $('#user-location-search').val();
        var queryURL = 'http://newsapi.org/v2/everything?q=' + search + '+' + location + '&apiKey=' + apiKey;
        $.ajax({
            url: queryURL,
            method: "GET"
        }).then(function(response) {
            console.log(response);
            responseData = response;
            console.log(queryURL);

            // attach to the DOM, use these lines to put the news articles in the DOM
            $('#news-div').empty();
            for (var i=0; i<5; i++) {
                var title = response.articles[i].title;
                var urlToImage = response.articles[i].urlToImage;
                var content = response.articles[i].content;
                let articleURL = response.articles[i].url;
                let sourceName = response.articles[i].source.name;
                
                // Create card
                let card = $('<div>').addClass('card').attr('style', 'width: inherit;');
                let cardTitle = $('<div>').addClass('card-divider news-title').text(title);
                let cardImage = $('<img>').attr('src', urlToImage)
                let cardContentDiv = $('<div>').addClass('card-section');
                let cardSnippet = $("<div>").text('"' + content + '"');
                let cardSource = $("<a>").attr('href', articleURL).text(sourceName);

                // Append card
                cardContentDiv.append(cardSnippet, '<br>', 'Read more at: ', cardSource);
                card.append(cardTitle, cardImage, cardContentDiv);
                newsDiv.append(card);
            }
            //
        });
    }
    function submitSearch() {
        dataDiv.parent().removeClass('display-none');
        newsDiv.parent().removeClass('display-none');
        newsAPI('coronavirus+covid-19', location);
    }

    $('#submit-button').on("click", function(event) {
        event.preventDefault();
        submitSearch();
    });
    // $("#user-location-search").on("change", function(event) {
    //     event.preventDefault();
    //     // var keycode = (event.keyCode ? event.keyCode : event.which); // listens for the Enter key only
    //     // if (keycode === "13") {
    //         submitSearch();
    //     // }
    // });
    // next we'll need to add user input for location, getting multiple articles, maybe a 'See more' option to get more articles
</script>



</html>